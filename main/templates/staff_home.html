{%extends "base.html"%}
{% load crispy_forms_tags %}

{%block head%}
<script type="text/javascript">

    $(document).ready(function(){
        {%include "staff_home.js"%}
    });

</script>

{%endblock head%}

{% block content %}
<div class="row justify-content-lg-center" v-cloak>
    <div class="col col-md-8">
        <div class="card">                  
            <div class="card-header">
                <span v-show="reconnecting">
                    Connecting <i class="fas fa-cog fa-spin fa-1x"></i>
                </span>

                <span class="float-right">
                    <button class="btn btn-outline-success" type="button" v-on:click = "sendCreateSession()" v-bind:disabled = "reconnecting || working">
                        <span v-html="createSessionButtonText"></span>
                    </button>
                </span>
                                                                
            </div>
            <div class="card-body">                      
                                
                <!-- session list -->
                <table class="table table-hover table-condensed table-responsive-md">                            

                    <caption style="caption-side:top;text-align: center;">Sessions</caption>

                    <thead>
                        <th scope="col">
                            <button type="button" class="btn btn-outline-link btn-sm" v-on:click = "sortByTitle()">
                                <span v-html="titleSortButtonText" class="table_header"></span>
                            </button>
                        </th> 
                        <th scope="col" style="text-align: center;">
                            <button type="button" class="btn btn-outline-link btn-sm" v-on:click = "sortByDate()">
                                <span v-html="dateSortButtonText" class="table_header"></span>
                            </button>                             
                        </th>
                        <th scope="col" style="text-align: center;">
                            Current Period
                        </th>
                        <th scope="col" style="text-align: center;">
                            Treatment
                        </th>                                                      
                        <th scope="col" style="text-align: center;">
                            Control
                        </th>
                    </thead>

                    <tbody id="sessionList">                                                  
                        <tr v-for="(s,index) in sessions" v-bind:key="s.id">                                                                          
                            <td> 
                                <a :href="'/staff-session/' + s.id + '/' "><span v-html="s.title"></span></a>                                        
                            </td>
                            <td style="text-align: center;"> 
                                <span v-html="s.start_date"></span>                                 
                            </td>
                            <td style="text-align: center;">    
                                <span v-html="s.current_period"></span>                                                             
                            </td>
                            <td style="text-align: center;">

                            </td>
                            <td style="text-align: center;">
                                <button v-bind:id="'deleteSession' + s.id" type="button" class="btn btn-outline-danger btn-sm"
                                        v-on:click = "sendDeleteSession(s.id)" v-bind:disabled = "reconnecting || working">
                                    Delete <i class="fas fa-user-minus fa-xs"></i>  
                                </button>
                            </td>
                        </tr>                                                    
                    </tbody>
                    
                </table>                 
                
            </div>                    
        </div>                
    </div>
</div>
{% endblock %}